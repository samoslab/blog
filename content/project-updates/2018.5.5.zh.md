+++
title = "Samos 一周开发周报"
tags = [
    "project",
]
date = "2018-05-05"
categories = [
    "project-update",
]
description = "Samos 一周开发周报."
+++


# 商务拓展部分

- samos的存储不仅可用于skywire，也可以用于其它的区块链项目，即将和一个coinmarketcap排名前50的项目进行合作

# 移动钱包部分

- skycoin社区版本的单币种钱包samos团队负责后端封装，封装最新版本
- samos多币种钱包UI确定，下周进入调试

# 内容团队

- 内容输出团队基本构建完成，两周内会给出完整的minipaer和新的service tech paper

# samos  storage 存储软件

深度优化provider, provider已经基本定型：

- 升级小文件存储方式
- 调整接口，区分小文件和大文件存取接口
- 实现了collector发送器基础版本，TODO:未来再实现使用文件队列配合内存队列发送器，保证消息都能发送到collector
- 实现了对多个存储目录/分区/磁盘的支持，实现了运行中不停服务增加存储目录的功能
- 完善了安全性
- 改进了接口错误信息返回方式
- 同时相应调整了tracker，并将collector提取为单独应用程序
- 客户端后台增加了目录上传，目录下载，和进度查看三个接口。
- 客户端web service增加了以上三个接口的http 接口
- 主要对各项主要功能进行了测试
- 前端开始做精简版用户界面

# samos miner

第一版的生产完成了工厂询价，有了新一版设计稿
![screenshot](/img/samos-miner-v2.png)


# skywire 硬件相关工程部分

## Orangerpi打包镜像

- 自动重新分区扩盘,自适应sdcard容量
如果不做自动分区,做出来的镜像必须要按sd card的每种容量做一个相应镜像,否则只能按照最小卡做.
老版亦有做自动适应容量,但是在第一次启动分区后并没有按照标准做法重启然后重新确认分区,只是继续使用原容量,等待下次重启.这种做法可以加快第一次启动的正常使用,但是带来的隐患是该次启动所有对盘的文件操作极容易丢失或损坏,因为下一次正常启动还需要确认和整理分区.但是现在用的方法需要自动重启两次,所以会造成首次使用的启动缓慢,用户体验感不好,暂时没有想到更好的解决办法.
- 修正域名解释
- 自动安装配置板上golang编译环境
- 写自启动全自动执行脚本

## 镜像bug修正

- 板外node无法注册进入manager
原因:orangepi无mac eeprom.mac已被uboot2默认,导致全部板的mac一样.在上级路由端同一个mac多个IP不断跳变,可以进行TCP通讯但UDP会丢失,所以导致注册不稳定.
- 第一次解决办法,第一次启动自动生成一个随机mac.
更新镜像后测试反馈问题,有些node没有连上.
- 第二次查发现改版的mac仍然有严重的bug,不能用全mac.导致随机生成的mac有部分会超界设置无效仍然会沿用原mac导致冲突.解决办法,直接第一次启动时候全部注入固定mac.但该方法隐患未知,老版亦用此种方案,但是该方案的后果是导致所有矿机内部8快板MAC不同,但全部矿机与矿机之间的mac全部相同.
- 所以注意!!!以后做矿机唯一的时候切勿用mac作为唯一标识.

## 出针对安全解决方案

- 针对skywire矿机的问题出针对性的vlan和pppoe的解决方案


# skywire 软件部分

- 配合8卡矿机制作镜像，进行orange pi的skywire代码交叉编译，并进行验证及稳定性测试；
- 在orange pi进行升级脚本调整与测试，并在新镜像实现在线升级，并在Orang pi系统实现本地编译，并解决一系列升级脚本与实时编译遇到的问题；
- 配合镜像测试解决一系列测试中出现的问题
- 发现当manager没有开启的情况下，node先开启自动崩溃的bug，提交修改代码，加入最外层大循环等待连上manager并取到token后才继续运行，解决崩溃问题。
- 制作应用接入说明文档，对SKYWIRE整体网络进行图解描述，对应用接入SKYWIRE进行图解及文字说明。
![screenshot](/img/skywire-app.png)
![screenshot](/img/skywire-arch.png)




